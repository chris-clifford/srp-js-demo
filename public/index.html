<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Basic Page Needs
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <meta charset="utf-8">
    <title>SiRP Demo : Secure (interoperable) Remote Password Authentication</title>
    <meta name="description" content="SiRP Demo : Secure (interoperable) Remote Password Authentication">
    <meta name="author" content="Glenn Rempe">

    <!-- Mobile Specific Metas
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- FONT
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

    <!-- CSS
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/app.css">

    <!-- Favicon
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="icon" type="image/png" href="images/favicon.png">
</head>

<body>
    <!-- Primary Page Layout
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <div class="container">
      <div class="row">
        <div class="twelve column" style="margin-top: 10%">

          <h1>SRP m2m-web Demo</h1>
          <p><b>Signup and Login Flow</b></p>

          <h3>About</h3>

          <h3>Step 1: User Signup</h3>

          <p>
            In this step a new user is registered by generating a salt and verifier in
            the browser and posting those attributes to the <code>/api/v8/signup</code> endoint on the server.
          </p>

          <form id='register'>
            <div class="row">
              <div class="six columns">
                <label for="regUsername">email</label>
                <input id='regUsername' class='u-full-width' type='text' name='username' autofocus><br>
              </div>

              <div class="six columns">
                <label for="regPassword">password</label>
                <input id='regPassword' class='u-full-width' type='password' name='password'>
              </div>
            </div>
            <div class="row">
              <h4 id='regMessage' class='nine columns green'></h4>
              <input id='regButton' class='three columns button-primary u-pull-right' type='button' value='Register'>
            </div>
          </form>

          <pre id='statusP0'></pre>

          <h3>Step 2: Confirm Email</h3>

          <p>
            In this step a new user confirms their email address by entering the pin
            posting to the <code>/api/v8/confirm</code> endoint on the server.
          </p>

          <form id='confirm'>
            <div class="row">
              <div class="six columns">
                <label for="confirmUsername">email</label>
                <input id='confirmUsername' class='u-full-width' type='text' name='username' autofocus><br>
              </div>

              <div class="six columns">
                <label for="confirmPin">pin</label>
                <input id='confirmPin' class='u-full-width' type='password' name='password'>
              </div>
            </div>
            <div class="row">
              <h4 id='confirmMessage' class='nine columns green'></h4>
              <input id='confirmButton' class='three columns button-primary u-pull-right' type='button' value='Confirm'>
            </div>
          </form>

          <pre id='statusP1'></pre>

          <h3>Step 3: User Login/Authentication</h3>

          <p>
            In this step an existing user requests an SRP protocol login <code>/api/v8/login</code>. The first
            step is to retrieve the user's 'salt' and the server's 'B' values from
            the server and use those to bootstrap the rest of the authentication
            process <code>/api/v8/validate_s</code>.
          </p>

          <form id='login'>
            <div class="row">
              <div class="six columns">
                <label for="loginUsername">email</label>
                <input id='loginUsername' class='u-full-width' type='text' name='username' autofocus><br>
              </div>

              <div class="six columns">
                <label for="loginPassword">password</label>
                <input id='loginPassword' class='u-full-width' type='password' name='password'>
              </div>
            </div>
            <div class="row">
              <h4 id='loginMessage' class='nine columns green'></h4>
              <input id='loginButton' class='three columns button-primary u-pull-right' type='button' value='Login'>
            </div>
          </form>


          <pre id='statusP2'></pre>
          <br/>

          <pre id='statusP3'></pre>
          <br/>

        </div>
      </div>
    </div>

    <!-- End Document
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->

    <script type="text/javascript" src="node_modules/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="node_modules/fast-sha256/sha256.min.js"></script>
    <script type="text/javascript" src="node_modules/scrypt-async/scrypt-async.min.js"></script>
    <script type="text/javascript" src="node_modules/gibberish-aes/dist/gibberish-aes-1.0.0.min.js"></script>
    <script type="text/javascript" src="node_modules/js-nacl/lib/nacl_factory.js"></script>
    <script>
      window.nacl = nacl_factory.instantiate(function (nacl) {
        alert(nacl.to_hex(nacl.random_bytes(16)));
      });
    </script>
    <script type="text/javascript" src="jsrp-browser.js"></script>
    <script type="text/javascript" src="app.js"></script>
</body>

</html>
